<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora de Préstamo Pro por JFMA (JF8989 en GitHub)</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
    <!-- html2pdf still included (unused for now) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script>
    <script src="{{ url_for('static', filename='scripts.js') }}" defer></script>
  </head>
  <body>
    <!-- Loading overlay (shown while submitting) -->
    <div id="loading-overlay" aria-hidden="true">
      <div class="spinner" role="status" aria-label="Calculando..."></div>
    </div>

    <div class="container">
      <header>
        <h1>Calculadora de Préstamo Pro</h1>
        <p class="author">Creado por JF8989</p>
        <nav>
          <a href="{{ url_for('index_en') }}">English</a>
          <button type="button" id="themeToggle" class="theme-toggle" aria-label="Cambiar tema">
            <i class="fas fa-moon"></i> Dark
          </button>
        </nav>
      </header>

      <main>
        <!-- novalidate: our JS handles client hints; server validates for real -->
        <form id="loanForm" method="POST" novalidate autocomplete="off">
          <div class="form-group tooltip">
            <label for="principal">Principal Actual:</label>
            <input
              type="text" id="principal" name="principal" inputmode="decimal"
              value="{{ form_data.principal }}" required
            />
            <i class="fas fa-dollar-sign input-icon"></i>
            <span class="tooltiptext">El monto actual que debes del préstamo</span>
          </div>

          <div class="form-group tooltip">
            <label for="tasa_anual">Tasa de Interés Anual:</label>
            <input
              type="text" id="tasa_anual" name="tasa_anual" inputmode="decimal"
              value="{{ form_data.tasa_anual }}" required
            />
            <i class="fas fa-percent input-icon"></i>
            <span class="tooltiptext">La tasa de interés anual del préstamo</span>
          </div>

          <div class="form-group tooltip">
            <label for="pago_mensual_fijo">Pago Mensual Fijo:</label>
            <input
              type="text" id="pago_mensual_fijo" name="pago_mensual_fijo" inputmode="decimal"
              value="{{ form_data.pago_mensual_fijo }}" required
            />
            <i class="fas fa-money-bill-wave input-icon"></i>
            <span class="tooltiptext">El pago mensual que estás obligado a hacer</span>
          </div>

          <div class="form-group tooltip">
            <label for="pago_mensual_adicional">Pago Mensual Adicional:</label>
            <input
              type="text" id="pago_mensual_adicional" name="pago_mensual_adicional" inputmode="decimal"
              value="{{ form_data.pago_mensual_adicional }}" required
            />
            <i class="fas fa-plus-circle input-icon"></i>
            <span class="tooltiptext">Cualquier pago adicional que desees hacer cada mes</span>
          </div>

          <div class="form-group plazo-group tooltip">
            <label for="plazo_anios">Plazo Restante del Préstamo:</label>
            <div class="plazo-inputs">
              <input
                type="text" id="plazo_anios" name="plazo_anios" inputmode="numeric"
                value="{{ form_data.plazo_anios }}" required placeholder="Años"
              />
              <input
                type="text" id="plazo_meses" name="plazo_meses" inputmode="numeric"
                value="{{ form_data.plazo_meses }}" required placeholder="Meses"
              />
            </div>
            <i class="fas fa-calendar-alt input-icon"></i>
            <span class="tooltiptext">Tiempo restante del préstamo (años y meses)</span>
          </div>

          <div class="form-group button-group">
            <button type="submit" class="btn-calculate">Calcular</button>
            <button type="button" class="btn-reset" onclick="resetForm()">Resetear</button>
          </div>
        </form>

        {% if error %}
        <div class="error-message" style="position:static; display:block; margin-top:10px;">
          {{ error }}
        </div>
        {% endif %}

        <!-- PRINT HEADER (screen-hidden, print-only) -->
        <div class="print-header" style="display:none;">
          <h1>Calculadora de Préstamo Pro</h1>
          <p class="author">Creado por JF8989</p>
        </div>

        <!-- Wrap results in #report-root so print exports start here -->
        <div id="report-root">
          <div id="results" class="results-container {% if not resumen %}hidden{% endif %}">
            {% if resumen %}
            <div class="summary">
              <h2>Resumen Final</h2>
              <p id="summary-text"></p>
              <div class="summary-grid">
                <div class="summary-item">
                  <i class="fas fa-clock"></i>
                  <p>{{ translations['Total Time'] }}</p>
                  <strong>{{ resumen[translations['Total Time']] }}</strong>
                </div>
                <div class="summary-item">
                  <i class="fas fa-hand-holding-usd"></i>
                  <p>{{ translations['Original Interest Without Additional Payments'] }}</p>
                  <strong>{{ resumen[translations['Original Interest Without Additional Payments']] }}</strong>
                </div>
                <div class="summary-item">
                  <i class="fas fa-money-bill-wave"></i>
                  <p>{{ translations['Total Interest Paid'] }}</p>
                  <strong>{{ resumen[translations['Total Interest Paid']] }}</strong>
                </div>
                <div class="summary-item">
                  <i class="fas fa-piggy-bank"></i>
                  <p>{{ translations['Total Interest Saved'] }}</p>
                  <strong>{{ resumen[translations['Total Interest Saved']] }}</strong>
                </div>
                <div class="summary-item">
                  <i class="fas fa-chart-line"></i>
                  <p>{{ translations['Initial Daily Interest'] }}</p>
                  <strong>{{ resumen[translations['Initial Daily Interest']] }}</strong>
                </div>
                <div class="summary-item">
                  <i class="fas fa-chart-line"></i>
                  <p>{{ translations['Final Daily Interest'] }}</p>
                  <strong>{{ resumen[translations['Final Daily Interest']] }}</strong>
                </div>
              </div>
            </div>
            {% endif %}
            {% if tables %}
            <div class="payment-details">
              <h2>{{ translations['Monthly Payment Details'] }}</h2>
              <div class="table-responsive">{{ tables[0]|safe }}</div>
            </div>
            <!-- PDF download action -->
            <div class="button-group" style="justify-content: flex-start; margin-top: 20px;">
              <button type="button" class="btn-download" onclick="downloadReportPDF()">
                <i class="fas fa-file-download"></i> Descargar PDF
              </button>
            </div>
            {% endif %}
          </div>
        </div>
      </main>
    </div>

    <footer class="site-footer">
      <div class="footer-content">
        <div class="footer-section about">
          <h3>Sobre la Calculadora de Préstamo Pro</h3>
          <p>
            Una herramienta avanzada para calcular y analizar préstamos,
            desarrollada con precisión y cuidado por JF8989.
          </p>
        </div>
        <div class="footer-section contact">
          <h3>Contacto</h3>
          <p><i class="fas fa-envelope"></i> juanfrajf.contacto@gmail.com</p>
        </div>
        <div class="footer-section social">
          <h3>Sígueme</h3>
          <a href="https://www.linkedin.com/in/jfmarcenaroa/" class="social-icon" target="_blank"><i class="fab fa-linkedin"></i></a>
          <a href="https://github.com/jf8989?tab=repositories" class="social-icon" target="_blank"><i class="fab fa-github"></i></a>
        </div>
        <div class="footer-section legal">
          <h3>Legal</h3>
          <button type="button" class="linklike" onclick="openLegal()">Legal Disclaimer</button>
        </div>
      </div>
      <div class="footer-bottom">
        <p class="copyright">
          © 2024 JF8989. Todos los derechos reservados. Este software y su
          código fuente están protegidos por leyes de derechos de autor. No se
          otorga ninguna licencia para su uso, modificación o distribución sin
          el permiso expreso por escrito del autor.
        </p>
      </div>
    </footer>

    <!-- LEGAL MODAL -->
    <div id="modal-backdrop" class="modal-backdrop" aria-hidden="true" onclick="closeLegal()"></div>
    <div id="legal-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="legal-title" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-header">
          <h3 id="legal-title">⚖️ Legal Disclaimer</h3>
          <button class="modal-close" aria-label="Close" onclick="closeLegal()">&times;</button>
        </div>
        <div class="modal-body">
          <p><strong>IMPORTANT: READ CAREFULLY BEFORE USING THE LOAN CALCULATOR PRO</strong></p>
          <p>The Loan Calculator Pro is provided for informational and educational purposes only. By using this calculator, you acknowledge and agree to the following:</p>
          <ul>
            <li><strong>Not Financial Advice:</strong> The information and results provided by this calculator do not constitute financial advice, legal advice, or any other type of professional advice. It is not intended to replace the advice of qualified financial professionals.</li>
            <li><strong>No Guarantee of Accuracy:</strong> While we strive for accuracy, we make no representations or warranties of any kind, express or implied, about the completeness, accuracy, reliability, suitability, or availability of the calculator or the information it provides.</li>
            <li><strong>User Responsibility:</strong> Any reliance you place on the information provided by this calculator is strictly at your own risk. It is your responsibility to verify all information and calculations before making any financial decisions.</li>
            <li><strong>No Liability:</strong> The creator of Loan Calculator Pro, its affiliates, partners, or contributors shall not be liable for any loss or damage, including without limitation, indirect or consequential loss or damage, or any loss or damage whatsoever arising from the use of this calculator.</li>
            <li><strong>Seek Professional Advice:</strong> Before making any financial decisions, especially those related to loans or large financial commitments, you should consult with a qualified financial advisor, accountant, or legal professional.</li>
            <li><strong>Changes and Updates:</strong> The information and functionality of this calculator may be changed or updated without notice. We are not responsible for keeping the calculator up-to-date or for any outcomes resulting from potential inaccuracies or outdated information.</li>
          </ul>
          <p>By using the Loan Calculator Pro, you signify your acceptance of this disclaimer. If you do not agree with any part of this disclaimer, please do not use the calculator.</p>

          <h4>📜 License</h4>
          <p>This project is proprietary and is not licensed for use, modification, or distribution. All rights reserved. However, you're welcome to use the live demo for personal, non-profit calculations.</p>

          <p><em>Remember: Understanding your loan terms is crucial. If you're just learning about loans, think of it like a piggy bank that gets hungrier over time. The sooner you feed it (pay it), the less hungry (interest) it gets! 🐷💰</em></p>
        </div>
      </div>
    </div>
  </body>
</html>
